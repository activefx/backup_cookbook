# THIS FILE HAS BEEN GENERATED BY CHEF
# ANY MANUAL MODIFICATIONS WILL BE OVERWRITTEN
#
# For more information:
#
# View the Git repository at https://github.com/meskyanichi/backup
# View the Wiki/Documentation at https://github.com/meskyanichi/backup/wiki
# View the issue log at https://github.com/meskyanichi/backup/issues
#
# When you're finished configuring this configuration file,
# you can run it from the command line by issuing the following command:
#
# $ backup -t my_backup [-c <path_to_configuration_file>]
#

<% @backup_tasks.each do |task| %>
  Backup::Model.new(<%= task[:id].to_sym %>, <%= task[:title] || "#{task[:id]} backup configuration") do
    <% ['database', 'archive', 'encrypt_with', 'compress_with', 'store_with', 'sync_with', 'notify_by'].each do |backup_module| %>
      <% if task[backup_module] && !task[backup_module].empty? %>
        <%= task[backup_module].each do |backup_module_task_name, values| %>

          <%= backup_module %> <%= backup_module_task_name %> do |x|
            <% sync_directories = values.delete('directories') %>
            <% values.each do |key, value| %>
              x.<%= key %> = <%= value %>
            <% end %>
            <% unless sync_directories.nil? %>
              x.directories do |directory|
                <% sync_directories.each do |key, value| %>
                  directory.<%= key %> = <%= value %>
                <% end %>
            <% end %>
          end

        <% end %>
      <% end %>
    <% end %>
  end
<% end %>

